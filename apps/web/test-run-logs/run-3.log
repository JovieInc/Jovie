
> @jovie/web@0.1.0 test
> NODE_OPTIONS=--max-old-space-size=8192 vitest run --config=vitest.config.mts

[dotenv@17.2.3] injecting env (0) from .env.test -- tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild

 RUN  v3.2.4 /Users/timwhite/Documents/GitHub/TBF/Jovie/apps/web

 â¯ lib/api-client/fetcher.test.ts (48 tests | 10 failed) 30605ms
   âœ“ fetcher > success cases > GET: returns parsed JSON data 233ms
   âœ“ fetcher > success cases > POST: sends body and returns response 14ms
   âœ“ fetcher > success cases > PUT: sends body and returns response 29ms
   âœ“ fetcher > success cases > PATCH: sends partial body and returns response 14ms
   âœ“ fetcher > success cases > DELETE: sends request and returns response 44ms
   âœ“ fetcher > success cases > handles 204 No Content responses 79ms
   âœ“ fetcher > success cases > handles empty response bodies 3ms
   âœ“ fetcher > success cases > includes custom headers in request 8ms
   âœ“ fetcher > WithResponse variants > getWithResponse: returns full response object 7ms
   âœ“ fetcher > WithResponse variants > postWithResponse: returns full response object 2ms
   âœ“ fetcher > error handling > throws ApiError for 400 Bad Request 7ms
   âœ“ fetcher > error handling > throws ApiError for 401 Unauthorized 3ms
   âœ“ fetcher > error handling > throws ApiError for 403 Forbidden 1ms
   âœ“ fetcher > error handling > throws ApiError for 404 Not Found 2ms
   âœ“ fetcher > error handling > throws ApiError for 409 Conflict 8ms
   âœ“ fetcher > error handling > throws ApiError for 422 Unprocessable Entity 3ms
   âœ“ fetcher > error handling > throws ApiError for 429 Rate Limited 2ms
   âœ“ fetcher > error handling > throws ApiError for 500 Server Error 5ms
   âœ“ fetcher > error handling > provides default error message when response has no error field 1ms
   âœ“ fetcher > error handling > includes response body in ApiError 6ms
   âœ“ fetcher > network errors > throws ApiError for network failures 2ms
   âœ“ fetcher > network errors > throws ApiError with ABORTED code for AbortError 7ms
   Ã— fetcher > timeout behavior > aborts request after timeout 10050ms
     â†’ Test timed out in 10000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   Ã— fetcher > timeout behavior > uses config timeout when option not specified 10009ms
     â†’ Test timed out in 10000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   âœ“ fetcher > timeout behavior > clears timeout on successful response 2ms
   âœ“ fetcher > response parsing > handles non-JSON content-type gracefully 1ms
   âœ“ fetcher > response parsing > tries to parse JSON even with wrong content-type 1ms
   âœ“ fetcher > response parsing > throws ApiError for JSON parse failures on success responses 1ms
   âœ“ fetcher > request method (result pattern) > returns ok: true with data on success 1ms
   âœ“ fetcher > request method (result pattern) > returns ok: false with error on failure 1ms
   âœ“ fetcher > request method (result pattern) > returns ok: false with error on network failure 0ms
   âœ“ fetcher > request method (result pattern) > supports POST with body 0ms
   Ã— fetcher > configuration > uses baseUrl from configuration 11ms
     â†’ expected "spy" to be called with arguments: [ â€¦(2) ][90m

Received: 

[1m  1st spy call:

[22m[2m  [[22m
[32m-   "https://api.example.com/items",[90m
[32m-   Anything,[90m
[31m+   "/items",[90m
[31m+   {[90m
[31m+     "body": undefined,[90m
[31m+     "cache": undefined,[90m
[31m+     "credentials": "same-origin",[90m
[31m+     "headers": {[90m
[31m+       "Content-Type": "application/json",[90m
[31m+     },[90m
[31m+     "method": "GET",[90m
[31m+     "signal": AbortSignal {},[90m
[31m+   },[90m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   Ã— fetcher > configuration > uses default headers from configuration 3ms
     â†’ expected "spy" to be called with arguments: [ '/items', ObjectContaining{â€¦} ][90m

Received: 

[1m  1st spy call:

[22m[2m  [[22m
[2m    "/items",[22m
[32m-   ObjectContaining {[90m
[32m-     "headers": ObjectContaining {[90m
[32m-       "Authorization": "Bearer token123",[90m
[32m-       "X-API-Key": "key123",[90m
[31m+   {[90m
[31m+     "body": undefined,[90m
[31m+     "cache": undefined,[90m
[31m+     "credentials": "same-origin",[90m
[31m+     "headers": {[90m
[31m+       "Content-Type": "application/json",[90m
[2m      },[22m
[31m+     "method": "GET",[90m
[31m+     "signal": AbortSignal {},[90m
[2m    },[22m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   âœ“ fetcher > configuration > allows request headers to override default headers 1ms
   Ã— fetcher > configuration > calls onError callback when error occurs 3ms
     â†’ expected "spy" to be called with arguments: [ Any<ApiError> ][90m

Number of calls: [1m0[22m
[39m
   Ã— fetcher > configuration > calls onResponse callback for successful responses 1ms
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ][90m

Number of calls: [1m0[22m
[39m
   Ã— fetcher > configuration > allows onResponse to transform the response 2ms
     â†’ expected { original: true } to deeply equal { original: true, transformed: true }
   Ã— fetcher > configuration > respects throwOnError: false configuration 3ms
     â†’ Not found
   âœ“ fetcher > createFetcher > creates independent fetcher with custom config 2ms
   âœ“ fetcher > createFetcher > custom fetcher does not affect global fetcher 1ms
   âœ“ fetcher > createFetcher > custom fetcher inherits global config 1ms
   Ã— fetcher > AbortSignal support > respects provided AbortSignal 10008ms
     â†’ Test timed out in 10000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   Ã— fetcher > AbortSignal support > respects already-aborted signal 7ms
     â†’ promise resolved "{}" instead of rejecting
   âœ“ fetcher > credentials > uses same-origin credentials by default 1ms
   âœ“ fetcher > credentials > allows overriding credentials per request 1ms
   âœ“ fetcher > cache control > passes cache option to fetch 0ms
   âœ“ fetcher > cache control > passes Next.js specific options 1ms
 â¯ tests/lib/ingestion/apple-music.test.ts (42 tests | 2 failed) 6420ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > accepts valid Apple Music artist URLs 33ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > accepts URLs with various regions 8ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects HTTP URLs 1ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects non-artist URLs 2ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects root URLs without artist path 2ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects invalid hosts 2ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects URLs without artist ID 1ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > handles malformed URLs gracefully 1ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects dangerous URL schemes 0ms
   âœ“ Apple Music Strategy > isAppleMusicUrl > rejects protocol-relative URLs 0ms
   âœ“ Apple Music Strategy > validateAppleMusicUrl > returns canonical URL for valid inputs 4ms
   âœ“ Apple Music Strategy > validateAppleMusicUrl > normalizes to lowercase 1ms
   âœ“ Apple Music Strategy > validateAppleMusicUrl > removes www prefix 1ms
   âœ“ Apple Music Strategy > validateAppleMusicUrl > returns null for invalid URLs 5ms
   âœ“ Apple Music Strategy > validateAppleMusicUrl > returns null for malformed URLs 7ms
   âœ“ Apple Music Strategy > validateAppleMusicUrl > returns null for dangerous schemes 0ms
   âœ“ Apple Music Strategy > extractAppleMusicArtistId > extracts artist ID from valid URLs 4ms
   âœ“ Apple Music Strategy > extractAppleMusicArtistId > extracts artist ID with www prefix 1ms
   âœ“ Apple Music Strategy > extractAppleMusicArtistId > returns null for invalid URLs 3ms
   âœ“ Apple Music Strategy > extractAppleMusicArtistId > returns null for URLs without artist ID 1ms
   âœ“ Apple Music Strategy > extractAppleMusicArtistId > returns null for malformed URLs 1ms
   âœ“ Apple Music Strategy > extractAppleMusic > extracts display name from og:title 3ms
   âœ“ Apple Music Strategy > extractAppleMusic > extracts display name from twitter:title 5ms
   âœ“ Apple Music Strategy > extractAppleMusic > cleans platform suffix from display name 1ms
   âœ“ Apple Music Strategy > extractAppleMusic > extracts avatar from og:image 2ms
   âœ“ Apple Music Strategy > extractAppleMusic > skips default Apple Music placeholder images 1ms
   âœ“ Apple Music Strategy > extractAppleMusic > extracts links from JSON-LD sameAs property 8ms
   Ã— Apple Music Strategy > extractAppleMusic > extracts links from data-href attributes 38ms
     â†’ expected false to be true // Object.is equality
   âœ“ Apple Music Strategy > extractAppleMusic > extracts external links from href attributes 22ms
   âœ“ Apple Music Strategy > extractAppleMusic > skips internal Apple Music links 8ms
   âœ“ Apple Music Strategy > extractAppleMusic > skips Apple internal domains 3ms
   âœ“ Apple Music Strategy > extractAppleMusic > deduplicates links 7ms
   âœ“ Apple Music Strategy > extractAppleMusic > handles empty HTML gracefully 0ms
   âœ“ Apple Music Strategy > extractAppleMusic > handles malformed HTML gracefully 0ms
   Ã— Apple Music Strategy > extractAppleMusic > extracts data from structured fixture 82ms
     â†’ expected [ 'instagram', 'soundcloud', â€¦(4) ] to include 'youtube_music'
   âœ“ Apple Music Strategy > extractAppleMusic > handles edge cases correctly 43ms
   âœ“ Apple Music Strategy > extractAppleMusic > handles minimal data gracefully 1ms
   âœ“ Apple Music Strategy > fetchAppleMusicDocument > throws ExtractionError for invalid URL 20ms
   âœ“ Apple Music Strategy > fetchAppleMusicDocument > throws ExtractionError for non-artist URL 10ms
   âœ“ Apple Music Strategy > fetchAppleMusicDocument > throws ExtractionError on 404  3036ms
   âœ“ Apple Music Strategy > fetchAppleMusicDocument > throws ExtractionError on 429 rate limit  3024ms
   âœ“ Apple Music Strategy > fetchAppleMusicDocument > returns HTML on success 12ms
 â¯ tests/lib/ingestion/beacons.test.ts (41 tests | 1 failed) 6311ms
   âœ“ Beacons Strategy > isBeaconsUrl > accepts valid beacons.ai URLs 33ms
   âœ“ Beacons Strategy > isBeaconsUrl > accepts valid beacons.page URLs 6ms
   âœ“ Beacons Strategy > isBeaconsUrl > rejects HTTP URLs 1ms
   âœ“ Beacons Strategy > isBeaconsUrl > rejects root URLs without handle 2ms
   âœ“ Beacons Strategy > isBeaconsUrl > rejects invalid hosts 2ms
   âœ“ Beacons Strategy > isBeaconsUrl > rejects reserved paths 6ms
   âœ“ Beacons Strategy > isBeaconsUrl > handles malformed URLs gracefully 1ms
   âœ“ Beacons Strategy > validateBeaconsUrl > returns canonical URL for valid inputs 7ms
   âœ“ Beacons Strategy > validateBeaconsUrl > returns null for invalid URLs 2ms
   âœ“ Beacons Strategy > validateBeaconsUrl > returns null for reserved paths 6ms
   âœ“ Beacons Strategy > validateBeaconsUrl > strips @ prefix from handles 1ms
   âœ“ Beacons Strategy > isValidHandle > accepts valid handles 7ms
   âœ“ Beacons Strategy > isValidHandle > rejects reserved handles 0ms
   âœ“ Beacons Strategy > isValidHandle > rejects handles that are too long 1ms
   âœ“ Beacons Strategy > isValidHandle > rejects empty handles 0ms
   âœ“ Beacons Strategy > normalizeHandle > lowercases handles 0ms
   âœ“ Beacons Strategy > normalizeHandle > strips @ prefix 0ms
   âœ“ Beacons Strategy > normalizeHandle > trims whitespace 2ms
   âœ“ Beacons Strategy > extractBeaconsHandle > extracts handle from valid URLs 9ms
   âœ“ Beacons Strategy > extractBeaconsHandle > normalizes handles to lowercase 1ms
   âœ“ Beacons Strategy > extractBeaconsHandle > strips @ prefix 0ms
   âœ“ Beacons Strategy > extractBeaconsHandle > returns null for invalid URLs 1ms
   âœ“ Beacons Strategy > extractBeaconsHandle > returns null for reserved paths 2ms
   âœ“ Beacons Strategy > extractBeaconsHandle > handles URLs with trailing slashes and paths 1ms
   âœ“ Beacons Strategy > extractBeacons > extracts display name from og:title 13ms
   âœ“ Beacons Strategy > extractBeacons > extracts display name from twitter:title 6ms
   âœ“ Beacons Strategy > extractBeacons > cleans up various Beacons suffixes 1ms
   âœ“ Beacons Strategy > extractBeacons > extracts avatar from og:image 2ms
   âœ“ Beacons Strategy > extractBeacons > skips default Beacons placeholder images 6ms
   âœ“ Beacons Strategy > extractBeacons > extracts external links 17ms
   âœ“ Beacons Strategy > extractBeacons > skips internal Beacons links 1ms
   âœ“ Beacons Strategy > extractBeacons > deduplicates links 16ms
   âœ“ Beacons Strategy > extractBeacons > handles empty HTML gracefully 2ms
   âœ“ Beacons Strategy > extractBeacons > sets correct source platform and signal 4ms
   Ã— Beacons Strategy > extractBeacons > prefers structured data sources before href scanning 53ms
     â†’ expected [ 'instagram', 'spotify', 'youtube' ] to deeply equal [ 'instagram', 'spotify', â€¦(1) ]
   âœ“ Beacons Strategy > extractBeacons > falls back when structured data is absent 17ms
   âœ“ Beacons Strategy > fetchBeaconsDocument > throws ExtractionError for invalid URL 22ms
   âœ“ Beacons Strategy > fetchBeaconsDocument > throws ExtractionError for reserved paths 4ms
   âœ“ Beacons Strategy > fetchBeaconsDocument > throws ExtractionError on 404  3023ms
   âœ“ Beacons Strategy > fetchBeaconsDocument > throws ExtractionError on 429 rate limit  3010ms
   âœ“ Beacons Strategy > fetchBeaconsDocument > returns HTML on success 11ms
 â¯ tests/lib/ingestion/linktree.test.ts (36 tests | 1 failed) 6199ms
   âœ“ Linktree Strategy > isLinktreeUrl > accepts valid linktr.ee URLs 18ms
   âœ“ Linktree Strategy > isLinktreeUrl > accepts valid linktree.com URLs 2ms
   âœ“ Linktree Strategy > isLinktreeUrl > rejects HTTP URLs 1ms
   âœ“ Linktree Strategy > isLinktreeUrl > rejects root URLs without handle 1ms
   âœ“ Linktree Strategy > isLinktreeUrl > rejects invalid hosts 13ms
   âœ“ Linktree Strategy > isLinktreeUrl > rejects invalid handles 2ms
   âœ“ Linktree Strategy > isLinktreeUrl > handles malformed URLs gracefully 1ms
   âœ“ Linktree Strategy > validateLinktreeUrl > returns canonical URL for valid inputs 5ms
   âœ“ Linktree Strategy > validateLinktreeUrl > returns null for invalid URLs 5ms
   âœ“ Linktree Strategy > validateLinktreeUrl > strips @ prefix from handles 5ms
   âœ“ Linktree Strategy > isValidHandle > accepts valid handles 7ms
   âœ“ Linktree Strategy > isValidHandle > rejects handles with invalid characters 1ms
   âœ“ Linktree Strategy > isValidHandle > rejects handles that are too long 0ms
   âœ“ Linktree Strategy > isValidHandle > rejects empty handles 3ms
   âœ“ Linktree Strategy > normalizeHandle > lowercases handles 0ms
   âœ“ Linktree Strategy > normalizeHandle > strips @ prefix 0ms
   âœ“ Linktree Strategy > normalizeHandle > trims whitespace 0ms
   âœ“ Linktree Strategy > extractLinktreeHandle > extracts handle from valid URLs 2ms
   âœ“ Linktree Strategy > extractLinktreeHandle > normalizes handles to lowercase 0ms
   âœ“ Linktree Strategy > extractLinktreeHandle > strips @ prefix 0ms
   âœ“ Linktree Strategy > extractLinktreeHandle > returns null for invalid URLs 1ms
   âœ“ Linktree Strategy > extractLinktreeHandle > handles URLs with trailing slashes and paths 1ms
   âœ“ Linktree Strategy > extractLinktree > extracts display name from og:title 7ms
   âœ“ Linktree Strategy > extractLinktree > extracts display name from twitter:title 1ms
   âœ“ Linktree Strategy > extractLinktree > extracts avatar from og:image 1ms
   âœ“ Linktree Strategy > extractLinktree > extracts external links 5ms
   âœ“ Linktree Strategy > extractLinktree > skips internal Linktree links 1ms
   âœ“ Linktree Strategy > extractLinktree > deduplicates links 10ms
   âœ“ Linktree Strategy > extractLinktree > handles empty HTML gracefully 5ms
   âœ“ Linktree Strategy > extractLinktree > handles malformed HTML gracefully 0ms
   Ã— Linktree Strategy > extractLinktree > prefers structured Next.js data when available 27ms
     â†’ expected [ 'instagram', 'spotify', â€¦(2) ] to deeply equal [ 'instagram', 'spotify', â€¦(2) ]
   âœ“ Linktree Strategy > extractLinktree > falls back to href scanning when structured data is missing 5ms
   âœ“ Linktree Strategy > fetchLinktreeDocument > throws ExtractionError for invalid URL 2ms
   âœ“ Linktree Strategy > fetchLinktreeDocument > throws ExtractionError on 404  3016ms
   âœ“ Linktree Strategy > fetchLinktreeDocument > throws ExtractionError on 429 rate limit  3030ms
   âœ“ Linktree Strategy > fetchLinktreeDocument > returns HTML on success 15ms
 â¯ tests/unit/links/useLinksManager.test.ts (33 tests | 2 failed) 7144ms
   âœ“ useLinksManager > initialization > should initialize with provided links 85ms
   âœ“ useLinksManager > initialization > should initialize with empty array when no links provided 6ms
   âœ“ useLinksManager > initialization > should have null lastAddedId on init 10ms
   âœ“ useLinksManager > initialization > should have null addingLink on init 4ms
   âœ“ useLinksManager > initialization > should have undefined prefillUrl on init 5ms
   âœ“ useLinksManager > idFor > should generate stable ID from platform and URL 7ms
   âœ“ useLinksManager > idFor > should generate consistent IDs for same link 3ms
   âœ“ useLinksManager > idFor > should use originalUrl as fallback when normalizedUrl is missing 3ms
   âœ“ useLinksManager > mapIdToIndex > should map link IDs to their indices 11ms
   âœ“ useLinksManager > mapIdToIndex > should update when links change 12ms
   âœ“ useLinksManager > linkIsVisible > should return true for links without isVisible property 8ms
   âœ“ useLinksManager > linkIsVisible > should return true for links with isVisible=true 2ms
   âœ“ useLinksManager > linkIsVisible > should return false for links with isVisible=false 2ms
   âœ“ useLinksManager > handleToggle > should toggle link visibility from visible to hidden 9ms
   âœ“ useLinksManager > handleToggle > should toggle link visibility from hidden to visible 4ms
   âœ“ useLinksManager > handleToggle > should toggle link visibility from undefined (true) to false 23ms
   âœ“ useLinksManager > handleRemove > should remove a link by index 37ms
   âœ“ useLinksManager > handleRemove > should remove the first link correctly 6ms
   âœ“ useLinksManager > handleRemove > should remove the last link correctly 37ms
   âœ“ useLinksManager > handleEdit > should set prefillUrl and remove the link 25ms
   âœ“ useLinksManager > handleEdit > should use originalUrl as fallback 8ms
   âœ“ useLinksManager > handleEdit > should do nothing for invalid index 8ms
   âœ“ useLinksManager > clearPrefillUrl > should clear the prefillUrl 2ms
   âœ“ useLinksManager > handleAdd > should add a new link  671ms
   âœ“ useLinksManager > handleAdd > should add isVisible:true to the link  675ms
   âœ“ useLinksManager > handleAdd > should call onLinkAdded callback  773ms
   âœ“ useLinksManager > handleAdd > should call onLinksChange callback  686ms
   Ã— useLinksManager > handleAdd > should set and clear addingLink during add 797ms
     â†’ expected null not to be null
   âœ“ useLinksManager > handleAdd > should set lastAddedId after adding  720ms
   âœ“ useLinksManager > handleAdd > should clear lastAddedId after timeout  751ms
   âœ“ useLinksManager > handleDuplicate > should not add duplicate links 23ms
   âœ“ useLinksManager > YouTube cross-category handling > should remove YouTube from social when added to dsp  757ms
   Ã— useLinksManager > MAX_SOCIAL_LINKS visibility > should prevent adding more than MAX_SOCIAL_LINKS social links 949ms
     â†’ expected [ { platform: { â€¦(6) }, â€¦(4) }, â€¦(5) ] to have a length of 5 but got 6
 â¯ tests/components/dashboard/UniversalLinkInput.keyboard.test.tsx (10 tests | 7 failed) 2575ms
   Ã— UniversalLinkInput Keyboard Accessibility > prefills URL after platform selection 1396ms
     â†’ Unable to find an accessible element with the role "textbox"

There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole

Ignored nodes: comments, script, style
[36m<body[39m
  [33mstyle[39m=[32m""[39m
[36m>[39m
  [36m<div />[39m
[36m</body>[39m
   Ã— UniversalLinkInput Keyboard Accessibility > supports fuzzy platform autosuggest + Enter to prefill 137ms
     â†’ Unable to find an accessible element with the role "combobox"

There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole

Ignored nodes: comments, script, style
[36m<body[39m
  [33mstyle[39m=[32m""[39m
[36m>[39m
  [36m<div />[39m
[36m</body>[39m
   Ã— UniversalLinkInput Keyboard Accessibility > allows typing handle after platform selection 250ms
     â†’ Unable to find an accessible element with the role "textbox"

There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole

Ignored nodes: comments, script, style
[36m<body[39m
  [33mstyle[39m=[32m""[39m
[36m>[39m
  [36m<div />[39m
[36m</body>[39m
   Ã— UniversalLinkInput Keyboard Accessibility > supports Enter key to add valid link 245ms
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ][90m

Number of calls: [1m0[22m
[39m
   âœ“ UniversalLinkInput Keyboard Accessibility > blocks Enter when URL has unsafe scheme 120ms
   Ã— UniversalLinkInput Keyboard Accessibility > supports Escape key to clear input 101ms
     â†’ [2mexpect([22m[31melement[39m[2m).toHaveValue([22m[32mhttps://spotify.com/test[39m[2m)[22m

Expected the element to have value:
[32m  https://spotify.com/test[39m
Received:
[31m  h[39m
   âœ“ UniversalLinkInput Keyboard Accessibility > dropdown trigger has visible focus ring 30ms
   Ã— UniversalLinkInput Keyboard Accessibility > clear button has visible focus ring 79ms
     â†’ Unable to find an accessible element with the role "button" and name `/clear input/i`

There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole

Ignored nodes: comments, script, style
[36m<body[39m
  [33mstyle[39m=[32m""[39m
[36m>[39m
  [36m<div />[39m
[36m</body>[39m
   Ã— UniversalLinkInput Keyboard Accessibility > Tab navigates through all interactive elements 101ms
     â†’ Unable to find an accessible element with the role "button" and name `/clear input/i`

There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole

Ignored nodes: comments, script, style
[36m<body[39m
  [33mstyle[39m=[32m""[39m
[36m>[39m
  [36m<div />[39m
[36m</body>[39m
   âœ“ UniversalLinkInput Keyboard Accessibility > dropdown opens with Enter/Space and navigates with arrow keys 113ms
 â¯ tests/unit/SupportPage.test.tsx (7 tests | 3 failed) 798ms
   âœ“ SupportPage > renders the support page correctly  380ms
   Ã— SupportPage > renders the contact support button as a link 62ms
     â†’ [2mexpect([22m[31melement[39m[2m).toHaveAttribute([22m[32m[32m"href"[32m[39m[2m, [22m[32m[32m"mailto:support@jov.ie"[32m[39m[2m) // element.getAttribute("href") === "mailto:support@jov.ie"[22m

Expected the element to have attribute:
[32m  href="mailto:support@jov.ie"[39m
Received:
[31m  href="mailto:support@meetjovie.com"[39m
   Ã— SupportPage > has proper accessibility attributes 27ms
     â†’ [2mexpect([22m[31melement[39m[2m).toHaveAttribute([22m[32m[32m"aria-label"[32m[39m[2m, [22m[32m[32m"Send email to support team at support@jov.ie"[32m[39m[2m) // element.getAttribute("aria-label") === "Send email to support team at support@jov.ie"[22m

Expected the element to have attribute:
[32m  aria-label="Send email to support team at support@jov.ie"[39m
Received:
[31m  aria-label="Send email to support team at support@meetjovie.com"[39m
   Ã— SupportPage > tracks analytics events when email is clicked 39ms
     â†’ expected "spy" to be called with arguments: [ 'Support Email Clicked', â€¦(1) ][90m

Received: 

[1m  1st spy call:

[22m[2m  [[22m
[2m    "Support Email Clicked",[22m
[2m    {[22m
[32m-     "email": "support@jov.ie",[90m
[31m+     "email": "support@meetjovie.com",[90m
[2m      "source": "support_page",[22m
[2m    },[22m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   âœ“ SupportPage > tracks page view on mount 24ms
   âœ“ SupportPage > has proper styling classes 248ms
   âœ“ SupportPage > renders within a Container component 10ms
 â¯ tests/unit/api/dashboard/profile.test.ts (6 tests | 3 failed) 122ms
   Ã— PUT /api/dashboard/profile > syncs username and display name to Clerk before updating the database 78ms
     â†’ expected 500 to be 200 // Object.is equality
   Ã— PUT /api/dashboard/profile > normalizes usernames before syncing 9ms
     â†’ expected 500 to be 200 // Object.is equality
   Ã— PUT /api/dashboard/profile > downloads the uploaded avatar and forwards it to Clerk 16ms
     â†’ expected 500 to be 200 // Object.is equality
   âœ“ PUT /api/dashboard/profile > rejects unsupported updates 8ms
   âœ“ PUT /api/dashboard/profile > rejects invalid display names 6ms
   âœ“ PUT /api/dashboard/profile > rejects invalid urls 3ms
 â¯ lib/http/parse-json.test.ts (4 tests | 1 failed) 66ms
   âœ“ parseJsonBody > returns parsed JSON for valid payloads 28ms
   Ã— parseJsonBody > logs and captures parse failures 16ms
     â†’ expected 'Unexpected token \'o\', "not-json" isâ€¦' to be undefined
   âœ“ parseJsonBody > includes error details in development mode 18ms
   âœ“ parseJsonBody > returns fallback when empty body is allowed 2ms
 â¯ tests/lib/platform-detection.test.ts (31 tests | 1 failed) 151ms
   âœ“ Platform Detection > Unsafe inputs > rejects dangerous schemes 31ms
   Ã— Platform Detection > Unsafe inputs > rejects encoded control characters 38ms
     â†’ expected true to be false // Object.is equality
   âœ“ Platform Detection > Unsafe inputs > normalizeUrl throws away dangerous inputs and returns original string 0ms
   âœ“ Platform Detection > Domain dot-fix normalization > auto-inserts missing dot for common platforms 10ms
   âœ“ Platform Detection > TikTok URL normalization > should normalize TikTok URLs correctly 1ms
   âœ“ Platform Detection > TikTok URL normalization > should not add duplicate @ symbol to TikTok handles 1ms
   âœ“ Platform Detection > TikTok URL normalization > should detect TikTok platform correctly 2ms
   âœ“ Platform Detection > TikTok URL normalization > should validate TikTok URLs with @ symbol 2ms
   âœ“ Platform Detection > TikTok URL normalization > should generate correct suggested title for TikTok handles 1ms
   âœ“ Platform Detection > Twitch and OnlyFans detection > detects Twitch profiles and validates format 8ms
   âœ“ Platform Detection > Twitch and OnlyFans detection > detects OnlyFans profiles and validates format 4ms
   âœ“ Platform Detection > Linktree detection > detects linktree hosts and normalizes URL 2ms
   âœ“ Platform Detection > getPlatformsByCategory > DSP platforms > returns dsp platforms 2ms
   âœ“ Platform Detection > getPlatformsByCategory > Social platforms > returns social media platforms 13ms
   âœ“ Platform Detection > getPlatformsByCategory > Earnings platforms > returns monetization platforms 2ms
   âœ“ Platform Detection > getPlatformsByCategory > Website platforms > returns link aggregators and personal websites 1ms
   âœ“ Platform Detection > getPlatformsByCategory > Unknown platforms > returns null for unknown platform IDs 0ms
   âœ“ Platform Detection > Category Sets > DSP_PLATFORMS > contains expected DSP platforms 1ms
   âœ“ Platform Detection > Category Sets > DSP_PLATFORMS > does not contain non-DSP platforms 0ms
   âœ“ Platform Detection > Category Sets > DSP_PLATFORMS > is consistent with getPlatformsByCategory 0ms
   âœ“ Platform Detection > Category Sets > SOCIAL_PLATFORMS > contains expected social platforms 13ms
   âœ“ Platform Detection > Category Sets > SOCIAL_PLATFORMS > does not contain non-social platforms 1ms
   âœ“ Platform Detection > Category Sets > SOCIAL_PLATFORMS > is consistent with getPlatformsByCategory 1ms
   âœ“ Platform Detection > Category Sets > EARNINGS_PLATFORMS > contains expected earnings platforms 0ms
   âœ“ Platform Detection > Category Sets > EARNINGS_PLATFORMS > does not contain non-earnings platforms 0ms
   âœ“ Platform Detection > Category Sets > EARNINGS_PLATFORMS > is consistent with getPlatformsByCategory 0ms
   âœ“ Platform Detection > Category Sets > WEBSITES_PLATFORMS > contains expected website platforms 0ms
   âœ“ Platform Detection > Category Sets > WEBSITES_PLATFORMS > does not contain non-website platforms 0ms
   âœ“ Platform Detection > Category Sets > WEBSITES_PLATFORMS > is consistent with getPlatformsByCategory 0ms
   âœ“ Platform Detection > Category Sets > Set consistency > all category Sets are mutually exclusive 7ms
   âœ“ Platform Detection > Category Sets > Set consistency > each category has a non-zero size 2ms
 â¯ tests/lib/monitoring/user-journey.test.ts (30 tests | 2 failed) 136ms
   âœ“ UserJourneyTracker > constructor > should initialize with journey name and steps 3ms
   âœ“ UserJourneyTracker > start > should track journey start event 4ms
   âœ“ UserJourneyTracker > start > should return self for chaining 3ms
   âœ“ UserJourneyTracker > start > should reset state when starting 7ms
   âœ“ UserJourneyTracker > nextStep > should track step progression 3ms
   âœ“ UserJourneyTracker > nextStep > should track time since start 3ms
   âœ“ UserJourneyTracker > nextStep > should track time since previous step 1ms
   âœ“ UserJourneyTracker > nextStep > should include custom data 1ms
   Ã— UserJourneyTracker > nextStep > should warn when no more steps 43ms
     â†’ expected "warn" to be called with arguments: [ Array(1) ][90m

Received: 

[1m  1st warn call:

[22m[2m  [[22m
[32m-   "Journey checkout has no more steps defined",[90m
[31m+   "[UserJourney] Journey has no more steps defined",[90m
[31m+   {[90m
[31m+     "currentStep": 1,[90m
[31m+     "journey": "checkout",[90m
[31m+     "totalSteps": 1,[90m
[31m+   },[90m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   âœ“ UserJourneyTracker > nextStep > should return self for chaining 2ms
   âœ“ UserJourneyTracker > nextStep > should dispatch custom event when window exists 2ms
   âœ“ UserJourneyTracker > goToStep > should jump to a specific step 2ms
   Ã— UserJourneyTracker > goToStep > should warn if step not found 12ms
     â†’ expected "warn" to be called with arguments: [ Array(1) ][90m

Received: 

[1m  1st warn call:

[22m[2m  [[22m
[32m-   "Step nonexistent not found in journey checkout",[90m
[31m+   "[UserJourney] Step not found in journey",[90m
[31m+   {[90m
[31m+     "availableSteps": [[90m
[31m+       "step1",[90m
[31m+     ],[90m
[31m+     "journey": "checkout",[90m
[31m+     "stepName": "nonexistent",[90m
[31m+   },[90m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   âœ“ UserJourneyTracker > goToStep > should include custom data 2ms
   âœ“ UserJourneyTracker > goToStep > should return self for chaining 1ms
   âœ“ UserJourneyTracker > complete > should track journey completion 8ms
   âœ“ UserJourneyTracker > complete > should track partial completion 5ms
   âœ“ UserJourneyTracker > complete > should track unsuccessful completion 11ms
   âœ“ UserJourneyTracker > complete > should track total time 7ms
   âœ“ UserJourneyTracker > complete > should include custom data 1ms
   âœ“ UserJourneyTracker > complete > should dispatch custom event when window exists 1ms
   âœ“ UserJourneyTracker > complete > should return self for chaining 0ms
   âœ“ UserJourneyTracker > abandon > should track journey abandonment 1ms
   âœ“ UserJourneyTracker > abandon > should handle abandonment before any steps 1ms
   âœ“ UserJourneyTracker > abandon > should track total time before abandonment 0ms
   âœ“ UserJourneyTracker > abandon > should include custom data 4ms
   âœ“ UserJourneyTracker > abandon > should return self for chaining 1ms
   âœ“ UserJourneyTracker > trackOnboardingFunnel > should create and start an onboarding journey 1ms
   âœ“ UserJourneyTracker > trackOnboardingFunnel > should have correct onboarding steps 2ms
   âœ“ UserJourneyTracker > trackOnboardingFunnel > should set up event listeners when window exists 1ms
 â¯ tests/lib/monitoring/api-latency.test.ts (46 tests | 39 failed) 537ms
   Ã— ApiLatencyCollector > constructor > should initialize with default options 14ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > constructor > should accept custom options 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > constructor > should start flush timer when flushInterval > 0 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > constructor > should not start flush timer when flushInterval is 0 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > record > should add a metric to the buffer 20ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > record > should return self for method chaining 10ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > record > should create metric with correct properties 2ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > record > should use provided timestamp when specified 3ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > record > should auto-flush when buffer reaches maxBufferSize 2ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > recordBatch > should add multiple metrics to the buffer 260ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > recordBatch > should return self for method chaining 88ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > recordBatch > should auto-flush during batch if buffer fills up 22ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > flush > should return and clear buffered metrics 12ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > flush > should check thresholds when autoCheckThresholds is true 5ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > flush > should not check thresholds when autoCheckThresholds is false 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > flush > should override autoCheckThresholds with checkThresholds parameter 3ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > flush > should skip threshold check when buffer is empty 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > flush > should return empty array when buffer is empty 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > getBufferSize > should return correct buffer size 9ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > getBufferedMetrics > should return a copy of buffered metrics 2ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > clear > should clear the buffer without checking thresholds 6ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > clear > should return self for method chaining 9ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > stopFlushTimer > should stop the automatic flush timer 10ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > stopFlushTimer > should be safe to call multiple times 2ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > dispose > should flush remaining metrics and stop timer 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > dispose > should be safe to call multiple times 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > automatic flush timer > should flush only when buffer is not empty 0ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— ApiLatencyCollector > automatic flush timer > should continue flushing on each interval 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   âœ“ createApiLatencyMetric > should create a metric with correct structure 14ms
   âœ“ createApiLatencyMetric > should support all HTTP methods 4ms
   âœ“ createApiLatencyMetric > should support various status codes 1ms
   âœ“ collectApiLatencyFromResponse > should calculate duration from start time 1ms
   âœ“ collectApiLatencyFromResponse > should extract status from response object 0ms
   âœ“ collectApiLatencyFromResponse > should create valid metric structure 1ms
   âœ“ collectApiLatencyFromResponse > should work with minimal response object 0ms
   Ã— Integration with PerformanceAlerts > threshold alerting > should trigger warning alert for latency > 500ms 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > threshold alerting > should trigger error alert for latency > 2000ms 0ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > threshold alerting > should trigger critical alert for latency > 5000ms 6ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > threshold alerting > should trigger all applicable thresholds for very slow requests 3ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > threshold alerting > should not trigger alert for fast requests 2ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > metric collection flow > should correctly flow from sample to alert 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > metric collection flow > should handle mixed endpoints in batch 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > metric collection flow > should integrate with createApiLatencyMetric utility 0ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > metric collection flow > should respect cooldown between alerts for same endpoint 2ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > automatic flushing with alerts > should check thresholds on auto-flush 1ms
     â†’ (intermediate value).addApiLatencyRules is not a function
   Ã— Integration with PerformanceAlerts > automatic flushing with alerts > should check thresholds on buffer full auto-flush 0ms
     â†’ (intermediate value).addApiLatencyRules is not a function
stdout | tests/lib/environment-validation.test.ts > Environment Validation > validateAndLogEnvironment > should run validation and return results
[EnvServer] Environment: development | Platform: darwin | Node: v20.17.0 { nodeEnv: [32m'development'[39m, platform: [32m'darwin'[39m, nodeVersion: [32m'v20.17.0'[39m }

 â¯ tests/lib/environment-validation.test.ts (15 tests | 1 failed) 66ms
   âœ“ Environment Validation > validateEnvironment > should validate environment variables for runtime context 4ms
   âœ“ Environment Validation > validateEnvironment > should validate environment variables for build context 1ms
   âœ“ Environment Validation > validateEnvironment > should have different validation for runtime vs build context 0ms
   Ã— Environment Validation > validateAndLogEnvironment > should run validation and return results 29ms
     â†’ expected "log" to be called at least once
   âœ“ Environment Validation > validateDatabaseEnvironment > should fail when DATABASE_URL is not set 3ms
   âœ“ Environment Validation > validateDatabaseEnvironment > should validate correct PostgreSQL URLs 13ms
   âœ“ Environment Validation > validateDatabaseEnvironment > should reject invalid database URLs 3ms
   âœ“ Environment Validation > validateDatabaseEnvironment > should reject URLs with invalid protocols 1ms
   âœ“ Environment Validation > validateDatabaseEnvironment > should require database name in URL 1ms
   âœ“ Environment Validation > validateEnvironmentForApiRoute > should validate required environment variables for API routes 2ms
   âœ“ Environment Validation > validateEnvironmentForApiRoute > should detect missing required variables 1ms
   âœ“ Environment Validation > validateEnvironmentForApiRoute > should return empty missing array when all variables are present 1ms
   âœ“ Environment Validation > validateEnvironmentForMiddleware > should validate basic middleware requirements 0ms
   âœ“ Environment Validation > validateEnvironmentForMiddleware > should return true when Clerk key is present 1ms
   âœ“ Environment Validation > validateEnvironmentForMiddleware > should return false when Clerk key is missing 0ms
 â¯ tests/lib/monitoring/performance.test.ts (8 tests | 2 failed) 79ms
   âœ“ PerformanceTracker > trackPageLoad > should not track when window is undefined 2ms
   âœ“ PerformanceTracker > trackPageLoad > should observe navigation entries when window exists 3ms
   âœ“ PerformanceTracker > trackPageLoad > should send metrics when navigation entry is received 1ms
   Ã— PerformanceTracker > trackPageLoad > should handle PerformanceObserver errors gracefully 61ms
     â†’ expected "error" to be called with arguments: [ â€¦(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "Failed to observe navigation timing:",[90m
[32m-   Any<Error>,[90m
[31m+   "[Performance] Failed to observe navigation timing",[90m
[31m+   {[90m
[31m+     "error": Error {[90m
[31m+       "message": "PerformanceObserver not supported",[90m
[31m+     },[90m
[31m+     "pageName": "/test-page",[90m
[31m+   },[90m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   âœ“ PerformanceTracker > trackResourceLoad > should not track when window is undefined 0ms
   âœ“ PerformanceTracker > trackResourceLoad > should observe resource entries when window exists 2ms
   âœ“ PerformanceTracker > trackResourceLoad > should filter resources by type when specified 1ms
   Ã— PerformanceTracker > trackResourceLoad > should handle PerformanceObserver errors gracefully 2ms
     â†’ expected "error" to be called with arguments: [ â€¦(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "Failed to observe resource timing:",[90m
[32m-   Any<Error>,[90m
[31m+   "[Performance] Failed to observe resource timing",[90m
[31m+   {[90m
[31m+     "error": Error {[90m
[31m+       "message": "PerformanceObserver not supported",[90m
[31m+     },[90m
[31m+     "resourceType": undefined,[90m
[31m+   },[90m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
 â¯ tests/lib/admin/roles.test.ts (8 tests | 1 failed) 45ms
   âœ“ Admin Roles > isAdmin > should return false for empty user ID 4ms
   âœ“ Admin Roles > isAdmin > should return true for user with admin role in database 10ms
   âœ“ Admin Roles > isAdmin > should return false for user without admin role 4ms
   âœ“ Admin Roles > isAdmin > should return false when user not found in database 2ms
   âœ“ Admin Roles > isAdmin > should cache admin status and not query database twice 1ms
   Ã— Admin Roles > isAdmin > should return false and fail closed on database error 18ms
     â†’ expected "error" to be called with arguments: [ â€¦(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "[admin/roles] Failed to check admin status:",[90m
[32m-   Any<Error>,[90m
[31m+   "[Admin-Roles] Failed to check admin status",[90m
[31m+   {[90m
[31m+     "error": Error {[90m
[31m+       "message": "Database connection failed",[90m
[31m+     },[90m
[31m+   },[90m
[2m  ][22m
[39m[90m

Number of calls: [1m1[22m
[39m
   âœ“ Admin Roles > isAdmin > should invalidate cache when requested 2ms
   âœ“ Admin Roles > isAdmin > should clear entire cache when requested 1ms
 â¯ tests/lib/monitoring/web-vitals.test.ts (16 tests | 15 failed) 59ms
   âœ“ Web Vitals > initWebVitals > should initialize all core web vitals listeners 3ms
   Ã— Web Vitals > initWebVitals > should call custom handler when metric is received 7ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > initWebVitals > should send metrics to analytics 9ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > CLS ratings > should rate CLS <= 0.1 as good 3ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > CLS ratings > should rate CLS > 0.1 and <= 0.25 as needs-improvement 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > CLS ratings > should rate CLS > 0.25 as poor 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > LCP ratings > should rate LCP <= 2500ms as good 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > LCP ratings > should rate LCP > 2500ms and <= 4000ms as needs-improvement 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > LCP ratings > should rate LCP > 4000ms as poor 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > INP ratings > should rate INP <= 200ms as good 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > INP ratings > should rate INP > 200ms and <= 500ms as needs-improvement 2ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > INP ratings > should rate INP > 500ms as poor 5ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > TTFB ratings > should rate TTFB <= 800ms as good 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > getRating (internal function tested via initWebVitals) > TTFB ratings > should rate TTFB > 800ms and <= 1800ms as needs-improvement 1ms
     â†’ Cannot read properties of undefined (reading '0')
   Ã— Web Vitals > trackPerformanceExperiment > should initialize web vitals with experiment context 14ms
     â†’ expected "spy" to be called at least once
   Ã— Web Vitals > trackPerformanceExperiment > should include experiment name in metric tracking 1ms
     â†’ Cannot read properties of undefined (reading '0')
 âœ“ tests/lib/ingestion/youtube.test.ts (32 tests) 6188ms
   âœ“ YouTube Strategy > fetchYouTubeAboutDocument > throws ExtractionError on 404  3027ms
   âœ“ YouTube Strategy > fetchYouTubeAboutDocument > throws ExtractionError on 429 rate limit  3026ms
 âœ“ tests/lib/analytics/pii-encryption.test.ts (21 tests) 6227ms
   âœ“ PII Encryption > encryptPII and decryptPII > should generate different ciphertext for same input (random IV)  821ms
   âœ“ PII Encryption > Email encryption helpers > should encrypt and decrypt email addresses  302ms
   âœ“ PII Encryption > IP encryption helpers > should encrypt and decrypt IPv6 addresses  1821ms
   âœ“ PII Encryption > Batch encryption helpers > should encrypt multiple fields at once  1308ms
   âœ“ PII Encryption > Batch encryption helpers > should decrypt multiple fields at once  1062ms
 âœ“ tests/lib/stripe/billing-hardening.test.ts (10 tests) 856ms
   âœ“ Billing Hardening - updateUserBillingStatus > Event Ordering > should skip events older than lastBillingEventAt  306ms
   âœ“ Billing Hardening - updateUserBillingStatus > Optimistic Locking > should fail after two optimistic lock failures  506ms
 âœ“ tests/integration/analytics-tracking.test.ts (15 tests) 9460ms
   âœ“ Analytics Tracking Integration > Security Hardening > should encrypt PII before storage  807ms
   âœ“ Analytics Tracking Integration > RLS Security > should not have RLS bypass capability  7268ms
 âœ“ tests/lib/utils/url-encryption.test.ts (34 tests) 6782ms
   âœ“ URL Encryption > encryptUrl > should include IV in result  477ms
   âœ“ URL Encryption > encryptUrl > should produce different ciphertext for same input (random IV)  895ms
   âœ“ URL Encryption > encryptUrl > should include auth tag and support round trip decryption  1033ms
   âœ“ URL Encryption > encryptUrl > should throw error when cipher creation fails  1145ms
   âœ“ URL Encryption > decryptUrl > should decrypt values generated by encryptUrl  1773ms
   âœ“ URL Encryption > decryptUrl > should throw error when encrypted payload is tampered  1100ms
 âœ“ tests/components/auth/OtpSignUpForm.test.tsx (10 tests) 2533ms
   âœ“ OtpSignUpForm > renders the signup form correctly  415ms
   âœ“ OtpSignUpForm > uses semantic design tokens for global error  301ms
   âœ“ OtpSignUpForm > supports the email sign-up flow end-to-end  323ms
   âœ“ OtpSignUpForm > has aria-live region for global errors  689ms
 âœ“ tests/unit/dashboard/DashboardOverview.test.tsx (3 tests) 4782ms
   âœ“ DashboardOverview > renders setup tasks when incomplete  2996ms
   âœ“ DashboardOverview > marks tasks complete based on data  833ms
   âœ“ DashboardOverview > supports copy-to-clipboard with aria-live status  941ms
 â¯ tests/bench/track-route.bench.test.ts (1 test | 1 failed) 11566ms
   Ã— track route synthetic benchmark > captures p50/p95 latency and ensures click persistence 11559ms
     â†’ Test timed out in 10000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
 âœ“ tests/unit/links/SortableLinkItem.test.tsx (29 tests) 6871ms
   âœ“ SortableLinkItem > rendering > should render the link pill with platform name  400ms
   âœ“ SortableLinkItem > menu items > should show "Edit" menu item  387ms
   âœ“ SortableLinkItem > menu items > should show "Hide" menu item when visible  1347ms
   âœ“ SortableLinkItem > menu items > should show "Show" menu item when hidden  360ms
   âœ“ SortableLinkItem > callbacks > should call onEdit with index when Edit is clicked  529ms
   âœ“ SortableLinkItem > callbacks > should call onToggle with index when Hide is clicked  541ms
   âœ“ SortableLinkItem > callbacks > should call onRemove with index when Delete is clicked  519ms
 âœ“ tests/components/dashboard/UniversalLinkInput.a11y.test.tsx (8 tests) 7749ms
   âœ“ UniversalLinkInput Accessibility > Search mode ARIA attributes > should have proper combobox role and ARIA attributes when in search mode  2970ms
   âœ“ UniversalLinkInput Accessibility > Search mode ARIA attributes > should have aria-expanded true when results are shown  2213ms
   âœ“ UniversalLinkInput Accessibility > Search mode ARIA attributes > should have listbox role on results container  754ms
   âœ“ UniversalLinkInput Accessibility > Search mode ARIA attributes > should have option role on each result item  772ms
   âœ“ UniversalLinkInput Accessibility > Screen reader status announcements > should announce empty results  481ms
   âœ“ UniversalLinkInput Accessibility > Exit search mode button > should have accessible label on exit button  331ms
 âœ“ tests/unit/links/IngestedSuggestions.test.tsx (25 tests) 3242ms
   âœ“ IngestedSuggestions > rendering > should render multiple suggestions  346ms
   âœ“ IngestedSuggestions > accept flow > should fire analytics events after async handler resolves  753ms
 âœ“ tests/unit/links/QuickAddSuggestions.test.tsx (16 tests) 2982ms
   âœ“ QuickAddSuggestions > rendering > should render all suggestion pills when no platforms are added  1284ms
 âœ“ tests/components/user-button.test.tsx (2 tests) 3620ms
   âœ“ UserButton billing actions > offers a direct upgrade checkout when the user is not on Pro  2217ms
   âœ“ UserButton billing actions > opens the Stripe billing portal for Pro users  1401ms
 âœ“ tests/components/dashboard/LinkActions.keyboard.test.tsx (5 tests) 8905ms
   âœ“ LinkActions Keyboard Accessibility > menu button opens dropdown and toggle is accessible  5293ms
   âœ“ LinkActions Keyboard Accessibility > menu button opens dropdown and remove is accessible  1559ms
   âœ“ LinkActions Keyboard Accessibility > shows correct toggle text based on visibility  1524ms
 âœ“ tests/unit/Form.test.tsx (12 tests) 1932ms
   âœ“ Form > renders children correctly  850ms
 âœ“ tests/unit/tooltip.test.tsx (18 tests | 2 skipped) 2038ms
   âœ“ Tooltip > Rendering > renders trigger without tooltip initially  526ms
 âœ“ tests/components/auth/OtpSignInForm.test.tsx (11 tests) 2942ms
   âœ“ OtpSignInForm > renders the signin form correctly  896ms
   âœ“ OtpSignInForm > renders both form steps  446ms
   âœ“ OtpSignInForm > supports the email sign-in flow end-to-end  516ms
 âœ“ tests/unit/TipPromo.test.tsx (6 tests) 548ms
   âœ“ TipPromo > renders the component when NEXT_PUBLIC_FEATURE_TIPS is "true"  334ms
 âœ“ tests/components/billing.test.tsx (12 tests) 2740ms
   âœ“ Billing Components > BillingPortalLink Component > renders with default props  1269ms
   âœ“ Billing Components > UpgradeButton Component > handles checkout creation error  367ms
 âœ“ tests/lib/analytics/query-timeout.test.ts (13 tests) 401ms
 âœ“ tests/unit/components/molecules/AvatarUploadable.test.tsx (25 tests | 1 skipped) 1599ms
   âœ“ AvatarUploadable Component > Display Mode (Non-uploadable) > renders as regular avatar when uploadable is false  375ms
 âœ“ tests/unit/dashboard/DashboardNav.test.tsx (6 tests) 1322ms
   âœ“ DashboardNav > renders primary navigation items  863ms
 âœ“ tests/unit/links/useSuggestions.test.ts (31 tests) 407ms
 âœ“ tests/unit/atoms/AvatarAvatar.error-handling.test.tsx (2 tests) 150ms
 âœ“ tests/components/admin-creator-profiles-with-sidebar.test.tsx (3 tests) 1719ms
   âœ“ AdminCreatorProfilesWithSidebar > renders rows and pagination summary with accessible link  1083ms
   âœ“ AdminCreatorProfilesWithSidebar > renders actions menu for unclaimed profiles  422ms
 âœ“ tests/unit/ClaimHandleForm.test.tsx (10 tests) 632ms
 âœ“ tests/unit/CopyToClipboardButton.test.tsx (15 tests) 660ms
 âœ“ tests/unit/feedback/StarterEmptyState.test.tsx (2 tests) 179ms
 âœ“ tests/unit/CTAButton.test.tsx (14 tests) 726ms
 âœ“ tests/unit/DataCard.test.tsx (16 tests) 426ms
 âœ“ tests/unit/profile/ProfilePrimaryCTA.test.tsx (1 test) 940ms
   âœ“ ProfilePrimaryCTA > shows Listen CTA (not Subscribe capture) while subscription status is hydrating from stored contacts  938ms
 âœ“ tests/unit/atoms/Toast.test.tsx (12 tests) 540ms
 âœ“ tests/unit/ClaimHandleForm.optimized.test.tsx (4 tests) 358ms
 âœ“ tests/unit/ProblemSolutionSection.optimized.test.tsx (4 tests) 833ms
   âœ“ ProblemSolutionSection (Optimized) > renders unified section with problem and solution content  344ms
   âœ“ ProblemSolutionSection (Optimized) > renders CTA button with proper attributes  331ms
 âœ“ tests/unit/Button.test.tsx (10 tests) 2542ms
   âœ“ Button > renders correctly with default props  1257ms
   âœ“ Button > renders with different variants  374ms
   âœ“ Button > renders with different sizes  338ms
 âœ“ tests/unit/PreFooterCTA.test.tsx (5 tests) 597ms
 âœ“ tests/unit/EmptyState.test.tsx (5 tests) 2208ms
   âœ“ EmptyState > renders heading, description, and icon  1483ms
